.\" Automatically generated by Pod::Man v1.34, Pod::Parser v1.13
.\"
.\" Standard preamble:
.\" ========================================================================
.de Sh \" Subsection heading
.br
.if t .Sp
.ne 5
.PP
\fB\\$1\fR
.PP
..
.de Sp \" Vertical space (when we can't use .PP)
.if t .sp .5v
.if n .sp
..
.de Vb \" Begin verbatim text
.ft CW
.nf
.ne \\$1
..
.de Ve \" End verbatim text
.ft R
.fi
..
.\" Set up some character translations and predefined strings.  \*(-- will
.\" give an unbreakable dash, \*(PI will give pi, \*(L" will give a left
.\" double quote, and \*(R" will give a right double quote.  | will give a
.\" real vertical bar.  \*(C+ will give a nicer C++.  Capital omega is used to
.\" do unbreakable dashes and therefore won't be available.  \*(C` and \*(C'
.\" expand to `' in nroff, nothing in troff, for use with C<>.
.tr \(*W-|\(bv\*(Tr
.ds C+ C\v'-.1v'\h'-1p'\s-2+\h'-1p'+\s0\v'.1v'\h'-1p'
.ie n \{\
.    ds -- \(*W-
.    ds PI pi
.    if (\n(.H=4u)&(1m=24u) .ds -- \(*W\h'-12u'\(*W\h'-12u'-\" diablo 10 pitch
.    if (\n(.H=4u)&(1m=20u) .ds -- \(*W\h'-12u'\(*W\h'-8u'-\"  diablo 12 pitch
.    ds L" ""
.    ds R" ""
.    ds C` ""
.    ds C' ""
'br\}
.el\{\
.    ds -- \|\(em\|
.    ds PI \(*p
.    ds L" ``
.    ds R" ''
'br\}
.\"
.\" If the F register is turned on, we'll generate index entries on stderr for
.\" titles (.TH), headers (.SH), subsections (.Sh), items (.Ip), and index
.\" entries marked with X<> in POD.  Of course, you'll have to process the
.\" output yourself in some meaningful fashion.
.if \nF \{\
.    de IX
.    tm Index:\\$1\t\\n%\t"\\$2"
..
.    nr % 0
.    rr F
.\}
.\"
.\" For nroff, turn off justification.  Always turn off hyphenation; it makes
.\" way too many mistakes in technical documents.
.hy 0
.if n .na
.\"
.\" Accent mark definitions (@(#)ms.acc 1.5 88/02/08 SMI; from UCB 4.2).
.\" Fear.  Run.  Save yourself.  No user-serviceable parts.
.    \" fudge factors for nroff and troff
.if n \{\
.    ds #H 0
.    ds #V .8m
.    ds #F .3m
.    ds #[ \f1
.    ds #] \fP
.\}
.if t \{\
.    ds #H ((1u-(\\\\n(.fu%2u))*.13m)
.    ds #V .6m
.    ds #F 0
.    ds #[ \&
.    ds #] \&
.\}
.    \" simple accents for nroff and troff
.if n \{\
.    ds ' \&
.    ds ` \&
.    ds ^ \&
.    ds , \&
.    ds ~ ~
.    ds /
.\}
.if t \{\
.    ds ' \\k:\h'-(\\n(.wu*8/10-\*(#H)'\'\h"|\\n:u"
.    ds ` \\k:\h'-(\\n(.wu*8/10-\*(#H)'\`\h'|\\n:u'
.    ds ^ \\k:\h'-(\\n(.wu*10/11-\*(#H)'^\h'|\\n:u'
.    ds , \\k:\h'-(\\n(.wu*8/10)',\h'|\\n:u'
.    ds ~ \\k:\h'-(\\n(.wu-\*(#H-.1m)'~\h'|\\n:u'
.    ds / \\k:\h'-(\\n(.wu*8/10-\*(#H)'\z\(sl\h'|\\n:u'
.\}
.    \" troff and (daisy-wheel) nroff accents
.ds : \\k:\h'-(\\n(.wu*8/10-\*(#H+.1m+\*(#F)'\v'-\*(#V'\z.\h'.2m+\*(#F'.\h'|\\n:u'\v'\*(#V'
.ds 8 \h'\*(#H'\(*b\h'-\*(#H'
.ds o \\k:\h'-(\\n(.wu+\w'\(de'u-\*(#H)/2u'\v'-.3n'\*(#[\z\(de\v'.3n'\h'|\\n:u'\*(#]
.ds d- \h'\*(#H'\(pd\h'-\w'~'u'\v'-.25m'\f2\(hy\fP\v'.25m'\h'-\*(#H'
.ds D- D\\k:\h'-\w'D'u'\v'-.11m'\z\(hy\v'.11m'\h'|\\n:u'
.ds th \*(#[\v'.3m'\s+1I\s-1\v'-.3m'\h'-(\w'I'u*2/3)'\s-1o\s+1\*(#]
.ds Th \*(#[\s+2I\s-2\h'-\w'I'u*3/5'\v'-.3m'o\v'.3m'\*(#]
.ds ae a\h'-(\w'a'u*4/10)'e
.ds Ae A\h'-(\w'A'u*4/10)'E
.    \" corrections for vroff
.if v .ds ~ \\k:\h'-(\\n(.wu*9/10-\*(#H)'\s-2\u~\d\s+2\h'|\\n:u'
.if v .ds ^ \\k:\h'-(\\n(.wu*10/11-\*(#H)'\v'-.4m'^\v'.4m'\h'|\\n:u'
.    \" for low resolution devices (crt and lpr)
.if \n(.H>23 .if \n(.V>19 \
\{\
.    ds : e
.    ds 8 ss
.    ds o a
.    ds d- d\h'-1'\(ga
.    ds D- D\h'-1'\(hy
.    ds th \o'bp'
.    ds Th \o'LP'
.    ds ae ae
.    ds Ae AE
.\}
.rm #[ #] #H #V #F C
.\" ========================================================================
.\"
.IX Title "SYNCTREE 1"
.TH SYNCTREE 1 "2008-03-26" "perl v5.8.0" "User Contributed Perl Documentation"
.SH "NAME"
synctree \- Normalize a tree of flat files with a tree of ClearCase elements
.SH "SYNOPSIS"
.IX Header "SYNOPSIS"
.Vb 1
\&  synctree -sbase /tmp/newcode -dbase /vobs_tps/xxx
.Ve
.PP
Take all files located under /tmp/newcode, remove the leading
\&\*(L"/tmp/newcode\*(R" from each of their pathnames, and place the remaining
relative paths under \*(L"/vobs_tps/xxx\*(R" as versioned elements, leaving
them checked out.
.PP
.Vb 1
\&  synctree -cr -yes -ci -sbase /vobs/hpux/bin -dbase /vobs_rel/hpux/bin
.Ve
.PP
Sync all files under \*(L"/vobs_rel/hpux/bin\*(R" with those in
\&\*(L"/vobs/hpux/bin\*(R", making sure to preserve their \s-1CR\s0's. Suppress
interactive prompting and check in all work when done.
.PP
.Vb 1
\&  synctree -sb /A/B -db /X/Y -map /A/B/foo /X/Y/bar /A/B/here /X/Y/there
.Ve
.PP
Take 'foo' from directory /A/B and check it in as 'bar' in /X/Y.
Similarly, create an element /X/Y/there with the contents of /A/B/here.
.SH "DESCRIPTION"
.IX Header "DESCRIPTION"
Synctree brings a \s-1VOB\s0 area into alignment with a specified set of files
from a source area. It's analogous in various ways to \fIclearfsimport\fR,
\&\fIcitree\fR, and \fIclearexport/clearimport\fR; see the \s-1COMPARISONS\s0 section
below.  Synctree is useful if you have a ClearCase tree that must be
kept in sync with a \s-1CVS\s0 tree during a transition period, or for
overlaying releases of third-party products upon previous ones, or
exporting deliverable \s-1DO\s0's from a nightly build to a release \s-1VOB\s0 while
preserving config records (\s-1CR\s0's) and labels, or similar.
.PP
The default operation is to mkelem all files which exist in
\&\fI<src>\fR but not in \fI<dest>\fR, modify any files which
exist in both but differ, but \fBnot\fR to remove files which are present
in \fI<dest>\fR and not in \fI<src>\fR.  Adding the
\&\fI\-rmname\fR flag will cause this removal to happen as well and thus make
the \fI<src>\fR and \fI<dest>\fR areas identical.
.PP
Synctree need not run in a view context itself but the directory named
by the \fI\-dbase\fR flag must provide a view context. The branching
behavior of any checkouts performed will be governed by that view's
config spec.  The \fI\-dbase\fR directory need not exist, as long as it
lies under a mounted \s-1VOB\s0 tag and in a view context. In other words,
synctree can auto-create the destination directory tree.
.PP
The list of source files to operate on may be provided with the
\&\fI\-flist\fR option or it may come from \f(CW@ARGV\fR. Any directories
encountered on the command line will be traversed recursively. If no
source-file-list is provided, the directory specified with \fI\-sbase\fR is
used as the default.
.PP
File paths may be given as relative or absolute. Destination paths are
determined as follows: all source filenames are first turned into
absolute paths if necessary, then the source preface given with the
\&\fI\-sbase\fR parameter is removed and replaced with the value of \fI\-dbase\fR
to produce the destination pathname (but see \s-1FILE\s0 \s-1MAPPING\s0 below).
.PP
ClearCase symbolic links are supported, even on Windows.  Note that,
unless you use the \fI\-rellinks\fR flag, the text of the link is
transported \fBverbatim\fR from source area to dest area; thus relative
symlinks may no longer resolve in the destination area.
.PP
Consider using the \fI\-n\fR flag the first time you use this on a valued
\&\s-1VOB\s0, even though nothing irreversible (\fIrmelem\fR, \fIrmbranch\fR,
\&\fIrmver\fR, \fIrmtype\fR, etc.) is \fBever\fR done by synctree.  And by the
same token use \fI\-yes\fR and \fI\-ci\fR with care.
.SH "OPTIONS"
.IX Header "OPTIONS"
Not all options are described here, only those requiring elaboration
beyond the \f(CW\*(C`\-help\*(C'\fR summary. Run \f(CW\*(C`synctree \-help\*(C'\fR for a full option
summary.
.IP "\(bu \fI\-force, \-stop\fR" 4
.IX Item "-force, -stop"
By default, upon encountering a ClearCase error synctree will attempt
to return to the initial state by undoing all checkouts etc. The
\&\fI\-stop\fR flag will cause it to exit immediately leaving the partial
state intact while \fI\-force\fR will cause it to blunder onward, ignoring
errors. However, even with \fI\-force\fR a nonzero status is returned if
errors are encountered.
.IP "\(bu \fI\-ignore_co, \-overwrite_co\fR" 4
.IX Item "-ignore_co, -overwrite_co"
By default, synctree refuses to run if any view-private files exist
under the destination base. This includes checkouts, which are a
special form of view private file. The \fI\-ignore_co\fR flag allows
synctree to continue in this situation. As the flag name implies it
will \fBignore\fR these checkouts; i.e. differences in the source base
will \fInot\fR overwrite the checked-out file in the destination.  The
\&\fI\-overwrite_co\fR flag also allows synctree to proceed in the presence
of existing checkouts but causes them to be overwritten by the source
version.
.IP "\(bu \fI\-no, \-yes, \-ci\fR" 4
.IX Item "-no, -yes, -ci"
The \fI\-no\fR flag causes synctree to report what it would do and exit
without making any changes, \fI\-yes\fR suppresses all prompts except for
the \f(CW\*(C`check in changes?\*(C'\fR prompt, and \fI\-ci\fR suppresses that one. The
default behavior is to prompt before making changes. To suppress all
prompting you must use both \fI\-yes\fR and \fI\-ci\fR.
.IP "\(bu \fI\-label, \-lbmods\fR" 4
.IX Item "-label, -lbmods"
The \fI\-label\fR option let you specify a label to be applied before
finishing. By default it will label recursively from the \fI\-dbase\fR area
down, as well as all parent directories upward to the vob root.  But if
the \fI\-lbmods\fR flag is used as well, only modified elements will be
labeled.
.IP "\(bu \fI\-reuse\fR" 4
.IX Item "-reuse"
If element X is created in synctree run #1, rmname'd in run #2, and 
created again in run #3, you may end up with multiple elements with
the same name. This situation is known as an \fIevil twin\fR. The
\&\fI\-reuse\fR flag can avoid this; before making a new element it
searches the directory's version tree looking for a prior element
of the same name. If found, it will link the old element back into
the current version of the directory, then (if the contents differ)
check it out and replace the contents with those of the source
file.
.Sp
This flag can avoid evil twins and save storage space but will run a
little slower due to the extra analysis. Also, there's no guarantee the
prior element of the same name is in fact logically related to the new
one. They could conceivably even be of different element types.
.Sp
\&\fIThe \f(BI\-reuse\fI feature is not well tested and should still be considered
\&\f(BIexperimental\fI.\fR
.IP "\(bu \fI\-Narrow\fR" 4
.IX Item "-Narrow"
The \fI\-Narrow\fR flag allows a regular expression to limit the files
from the source list which are compared with the destination base.
I.e. if you want to transport all the \f(CW\*(C`*.java\*(C'\fR files from a
dir tree without the class files you can use
.Sp
.Vb 1
\&    synctree -N '\e.java\e$' ...
.Ve
.Sp
Note that the argument is a Perl regular expression, not a file glob.
Any legal Perl \s-1RE\s0 may be used. Also, multiple \fI\-Narrow\fR flags may be
used; thus, to collect \f(CW\*(C`*.class\*(C'\fR and \f(CW\*(C`*.properties\*(C'\fR files you may use
either of:
.Sp
.Vb 2
\&    synctree -N '\e.class\e$' -N '\e.properties\e$' ...
\&    synctree -N '\e.(class|properties)\e$' ...
.Ve
.Sp
Also, the \fI\-Narrow\fR flag is considered only for file lists derived
internally by synctree. If you provide your own file list using
\&\fI\-flist\fR, filtering it is your own responsibility.
.Sp
This \s-1RE\s0 is automatically made case-insensitive on Windows.
.SH "FILE MAPPING"
.IX Header "FILE MAPPING"
Synctree has lots of support for remapping filenames. The options can
be pretty confusing and thus deserve special treatment here.
.PP
Filename mapping is enabled with the \fB\-map\fR flag.  Without \fI\-map\fR, a
list of files provided on the command line is interpreted as a set of
\&\fIfrom\fR files; their \fIto\fR paths are derived via \fIs/^sbase/dbase/\fR and
thus the file basenames cannot change.  In the presence of \fI\-map\fR the
arguments are instead interpreted as a hash alternating \fBfrom\fR and
\&\fBto\fR names.  Thus
.PP
.Vb 1
\&  synctree -sb /etc -db /vobs_st/etc /etc/passwd /etc/group
.Ve
.PP
would make two files under /vobs_st/etc called passwd and group, whereas
.PP
.Vb 1
\&  synctree -sb /etc -db /vobs_st/etc -map /etc/passwd /vobs_st/etc/foo
.Ve
.PP
would create one file (/vobs_st/etc/foo) which is a copy of /etc/passwd.
Alternatively the mapping may be specified with a literal \fB=>\fR:
.PP
.Vb 1
\&  synctree -sb /etc -db /vobs_st/etc -map '/etc/passwd => /vobs_st/etc/foo' ...
.Ve
.PP
but note that this must be quoted against shell expansion. The
\&\fI=>\fR style is also allowed in files specified via \fB\-flist\fR,
thus:
.PP
.Vb 4
\&  synctree -sb /etc -db /vobs_st/etc -flist - << EOF
\&  /etc/passwd => /vobs_st/etc/foo
\&  /etc/group  => /vobs_st/etc/bar
\&  EOF
.Ve
.SH "COMPARISONS"
.IX Header "COMPARISONS"
Synctree is comparable to \fIcitree\fR and \fIclearfsimport\fR. It is similar
to citree but has more options and runs on both Windows and \s-1UNIX\s0. It
has the following advantages over clearfsimport:
.IP "\(bu" 4
Synctree works with all ClearCase versions whereas clearfsimport is
first supported in \s-1CC\s0 4.2.
.IP "\(bu" 4
Synctree is capable of preserving \s-1CR\s0's during \f(CW\*(C`MVFS\->MVFS\*(C'\fR transfers
whereas clearfsimport always treats the source area as flat files.
.IP "\(bu" 4
Synctree has support for mapping filenames in transit and a \fI\-Narrow\fR
option for limiting the set of files to transfer.
.IP "\(bu" 4
Synctree is built on a documented \s-1API\s0 (\fBClearCase::SyncTree\fR) which is
available for custom tool development in Perl, whereas clearfsimport is
a command-line interface only.
.IP "\(bu" 4
Synctree has support for \fIelement reuse\fR. I.e. if an element is
added in one pass and removed (rmnamed) in a subsequent pass, and if a
third pass would make another element of the same name, synctree can
optionally (\fI\-reuse\fR) make a link to the existing file instead of
creating a new element which might be considered an \*(L"evil twin\*(R".
.PP
However, unless you need one of the above features the supported,
integrated solution (\fBclearfsimport\fR) is generally preferable. And of
course some of these features \fImay\fR eventually be supported by
clearfsimport; check current documentation.
.SH "BUGS"
.IX Header "BUGS"
.IP "\(bu" 4
Subtraction of symlinks is currently unimplemented. This could be made
to work, it's just a corner case I haven't gotten to.
.IP "\(bu" 4
SyncTree does not transport empty directories, and added/removed
directories aren't shown explicitly in the list of operations to be
performed. This is a structural artifact. It could presumably be
fixed by adding an extra phase which looks for empty dirs.
.IP "\(bu" 4
I have not tested SyncTree in snapshot views and would not expect it to
work there without modifications.
.SH "DEBUGGING"
.IX Header "DEBUGGING"
The special flag \fI\-/dbg=1\fR will cause all underlying cleartool
commands to be printed as they are run (this is actually a feature of
the Argv module on which \fIsynctree\fR is built). Please run in this mode
and include all output when reporting problems.
.SH "AUTHOR"
.IX Header "AUTHOR"
David Boyce <dsbperl \s-1AT\s0 boyski.com>
.SH "COPYRIGHT"
.IX Header "COPYRIGHT"
Copyright (c) 2000\-2004 David Boyce. All rights reserved.  This Perl
program is free software; you may redistribute and/or modify it under
the same terms as Perl itself.
.SH "SEE ALSO"
.IX Header "SEE ALSO"
\&\fIperl\fR\|(1), \*(L"perldoc ClearCase::SyncTree\*(R"
